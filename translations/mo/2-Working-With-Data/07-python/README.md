<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "577a611517482c3ceaf76d3d8142cba9",
  "translation_date": "2025-09-06T06:54:00+00:00",
  "source_file": "2-Working-With-Data/07-python/README.md",
  "language_code": "mo"
}
-->
# ä½¿ç”¨æ•¸æ“šï¼šPython å’Œ Pandas åº«

| ![ç”± [(@sketchthedocs)](https://sketchthedocs.dev) ç¹ªè£½çš„é€Ÿè¨˜ç­†è¨˜](../../sketchnotes/07-WorkWithPython.png) |
| :-------------------------------------------------------------------------------------------------------: |
|                 ä½¿ç”¨ Python - _ç”± [@nitya](https://twitter.com/nitya) ç¹ªè£½çš„é€Ÿè¨˜ç­†è¨˜_                     |

[![ä»‹ç´¹å½±ç‰‡](../../../../2-Working-With-Data/07-python/images/video-ds-python.png)](https://youtu.be/dZjWOGbsN4Y)

é›–ç„¶è³‡æ–™åº«æä¾›äº†éå¸¸é«˜æ•ˆçš„æ–¹å¼ä¾†å­˜å„²æ•¸æ“šä¸¦ä½¿ç”¨æŸ¥è©¢èªè¨€é€²è¡ŒæŸ¥è©¢ï¼Œä½†æœ€éˆæ´»çš„æ•¸æ“šè™•ç†æ–¹å¼æ˜¯ç·¨å¯«è‡ªå·±çš„ç¨‹å¼ä¾†æ“ä½œæ•¸æ“šã€‚åœ¨è¨±å¤šæƒ…æ³ä¸‹ï¼Œä½¿ç”¨è³‡æ–™åº«æŸ¥è©¢å¯èƒ½æ›´æœ‰æ•ˆã€‚ç„¶è€Œï¼Œåœ¨æŸäº›éœ€è¦æ›´è¤‡é›œæ•¸æ“šè™•ç†çš„æƒ…æ³ä¸‹ï¼Œä½¿ç”¨ SQL å¯èƒ½ä¸å®¹æ˜“å®Œæˆã€‚

æ•¸æ“šè™•ç†å¯ä»¥ç”¨ä»»ä½•ç¨‹å¼èªè¨€ç·¨å¯«ï¼Œä½†æœ‰äº›èªè¨€åœ¨è™•ç†æ•¸æ“šæ–¹é¢æ›´é«˜æ•ˆã€‚æ•¸æ“šç§‘å­¸å®¶é€šå¸¸åå¥½ä»¥ä¸‹å¹¾ç¨®èªè¨€ï¼š

* **[Python](https://www.python.org/)**ï¼šä¸€ç¨®é€šç”¨ç¨‹å¼èªè¨€ï¼Œå› å…¶ç°¡å–®æ€§å¸¸è¢«èªç‚ºæ˜¯åˆå­¸è€…çš„æœ€ä½³é¸æ“‡ã€‚Python æ“æœ‰è¨±å¤šé¡å¤–çš„åº«ï¼Œå¯ä»¥å¹«åŠ©è§£æ±ºè¨±å¤šå¯¦éš›å•é¡Œï¼Œä¾‹å¦‚å¾ ZIP å£“ç¸®æª”æ¡ˆä¸­æå–æ•¸æ“šæˆ–å°‡åœ–ç‰‡è½‰æ›ç‚ºç°åº¦ã€‚é™¤äº†æ•¸æ“šç§‘å­¸ï¼ŒPython ä¹Ÿå¸¸ç”¨æ–¼ç¶²é é–‹ç™¼ã€‚
* **[R](https://www.r-project.org/)**ï¼šä¸€å€‹å‚³çµ±å·¥å…·ç®±ï¼Œå°ˆç‚ºçµ±è¨ˆæ•¸æ“šè™•ç†è€Œè¨­è¨ˆã€‚å®ƒæ“æœ‰å¤§é‡çš„åº«ï¼ˆCRANï¼‰ï¼Œä½¿å…¶æˆç‚ºæ•¸æ“šè™•ç†çš„è‰¯å¥½é¸æ“‡ã€‚ç„¶è€Œï¼ŒR ä¸æ˜¯é€šç”¨ç¨‹å¼èªè¨€ï¼Œé€šå¸¸åƒ…é™æ–¼æ•¸æ“šç§‘å­¸é ˜åŸŸä½¿ç”¨ã€‚
* **[Julia](https://julialang.org/)**ï¼šå¦ä¸€ç¨®å°ˆç‚ºæ•¸æ“šç§‘å­¸è¨­è¨ˆçš„èªè¨€ã€‚å®ƒæ—¨åœ¨æä¾›æ¯” Python æ›´å¥½çš„æ€§èƒ½ï¼Œæ˜¯ç§‘å­¸å¯¦é©—çš„ç†æƒ³å·¥å…·ã€‚

åœ¨æœ¬èª²ç¨‹ä¸­ï¼Œæˆ‘å€‘å°‡é‡é»ä½¿ç”¨ Python é€²è¡Œç°¡å–®çš„æ•¸æ“šè™•ç†ã€‚æˆ‘å€‘å‡è¨­æ‚¨å·²å…·å‚™åŸºæœ¬çš„ Python çŸ¥è­˜ã€‚å¦‚æœæ‚¨æƒ³æ·±å…¥äº†è§£ Pythonï¼Œå¯ä»¥åƒè€ƒä»¥ä¸‹è³‡æºï¼š

* [ä½¿ç”¨ Turtle Graphics å’Œ Fractals å¿«æ¨‚å­¸ç¿’ Python](https://github.com/shwars/pycourse) - åŸºæ–¼ GitHub çš„å¿«é€Ÿ Python ç¨‹å¼è¨­è¨ˆå…¥é–€èª²ç¨‹
* [å¾ Python é–‹å§‹æ‚¨çš„ç¬¬ä¸€æ­¥](https://docs.microsoft.com/en-us/learn/paths/python-first-steps/?WT.mc_id=academic-77958-bethanycheum) - [Microsoft Learn](http://learn.microsoft.com/?WT.mc_id=academic-77958-bethanycheum) ä¸Šçš„å­¸ç¿’è·¯å¾‘

æ•¸æ“šå¯ä»¥æœ‰å¤šç¨®å½¢å¼ã€‚åœ¨æœ¬èª²ç¨‹ä¸­ï¼Œæˆ‘å€‘å°‡æ¢è¨ä¸‰ç¨®æ•¸æ“šå½¢å¼ï¼š**è¡¨æ ¼æ•¸æ“š**ã€**æ–‡æœ¬**å’Œ**åœ–ç‰‡**ã€‚

æˆ‘å€‘å°‡å°ˆæ³¨æ–¼ä¸€äº›æ•¸æ“šè™•ç†çš„ä¾‹å­ï¼Œè€Œä¸æ˜¯å…¨é¢ä»‹ç´¹æ‰€æœ‰ç›¸é—œåº«ã€‚é€™æ¨£å¯ä»¥å¹«åŠ©æ‚¨äº†è§£ä¸»è¦æ¦‚å¿µï¼Œä¸¦åœ¨éœ€è¦æ™‚çŸ¥é“å¦‚ä½•å°‹æ‰¾è§£æ±ºæ–¹æ¡ˆã€‚

> **æœ€æœ‰ç”¨çš„å»ºè­°**ï¼šç•¶æ‚¨éœ€è¦å°æ•¸æ“šåŸ·è¡ŒæŸäº›æ“ä½œä½†ä¸çŸ¥é“å¦‚ä½•é€²è¡Œæ™‚ï¼Œå˜—è©¦åœ¨ç¶²è·¯ä¸Šæœç´¢ã€‚[Stackoverflow](https://stackoverflow.com/) é€šå¸¸åŒ…å«è¨±å¤šé‡å°å¸¸è¦‹ä»»å‹™çš„ Python ç¯„ä¾‹ç¨‹å¼ç¢¼ã€‚

## [èª²å‰æ¸¬é©—](https://ff-quizzes.netlify.app/en/ds/quiz/12)

## è¡¨æ ¼æ•¸æ“šå’Œ DataFrame

ç•¶æˆ‘å€‘è¨è«–é—œè¯å¼è³‡æ–™åº«æ™‚ï¼Œæ‚¨å·²ç¶“æ¥è§¸éè¡¨æ ¼æ•¸æ“šã€‚ç•¶æ‚¨æ“æœ‰å¤§é‡æ•¸æ“šä¸”å®ƒåŒ…å«åœ¨è¨±å¤šä¸åŒçš„é€£çµè¡¨ä¸­æ™‚ï¼Œä½¿ç”¨ SQL ä¾†è™•ç†å®ƒæ˜¯éå¸¸åˆç†çš„ã€‚ç„¶è€Œï¼Œåœ¨è¨±å¤šæƒ…æ³ä¸‹ï¼Œæˆ‘å€‘æœ‰ä¸€å€‹æ•¸æ“šè¡¨ï¼Œä¸¦éœ€è¦å°é€™äº›æ•¸æ“šé€²è¡Œä¸€äº›**ç†è§£**æˆ–**æ´å¯Ÿ**ï¼Œä¾‹å¦‚åˆ†ä½ˆæƒ…æ³ã€å€¼ä¹‹é–“çš„ç›¸é—œæ€§ç­‰ã€‚åœ¨æ•¸æ“šç§‘å­¸ä¸­ï¼Œç¶“å¸¸éœ€è¦å°åŸå§‹æ•¸æ“šé€²è¡Œä¸€äº›è½‰æ›ï¼Œç„¶å¾Œé€²è¡Œå¯è¦–åŒ–ã€‚é€™å…©å€‹æ­¥é©Ÿéƒ½å¯ä»¥è¼•é¬†åœ°ä½¿ç”¨ Python å®Œæˆã€‚

åœ¨ Python ä¸­ï¼Œæœ‰å…©å€‹æœ€æœ‰ç”¨çš„åº«å¯ä»¥å¹«åŠ©æ‚¨è™•ç†è¡¨æ ¼æ•¸æ“šï¼š
* **[Pandas](https://pandas.pydata.org/)**ï¼šå…è¨±æ‚¨æ“ä½œæ‰€è¬‚çš„ **DataFrame**ï¼Œé¡ä¼¼æ–¼é—œè¯å¼è¡¨æ ¼ã€‚æ‚¨å¯ä»¥æ“æœ‰å‘½åçš„åˆ—ï¼Œä¸¦å°è¡Œã€åˆ—ä»¥åŠæ•´å€‹ DataFrame åŸ·è¡Œä¸åŒçš„æ“ä½œã€‚
* **[Numpy](https://numpy.org/)**ï¼šæ˜¯ä¸€å€‹ç”¨æ–¼è™•ç† **å¼µé‡**ï¼ˆå³å¤šç¶­**é™£åˆ—**ï¼‰çš„åº«ã€‚é™£åˆ—çš„å€¼å…·æœ‰ç›¸åŒçš„åŸºç¤é¡å‹ï¼Œæ¯” DataFrame æ›´ç°¡å–®ï¼Œä½†æä¾›äº†æ›´å¤šçš„æ•¸å­¸æ“ä½œï¼Œä¸¦ä¸”é–‹éŠ·æ›´å°‘ã€‚

æ­¤å¤–ï¼Œé‚„æœ‰å¹¾å€‹æ‚¨æ‡‰è©²äº†è§£çš„åº«ï¼š
* **[Matplotlib](https://matplotlib.org/)**ï¼šç”¨æ–¼æ•¸æ“šå¯è¦–åŒ–å’Œç¹ªè£½åœ–è¡¨çš„åº«
* **[SciPy](https://www.scipy.org/)**ï¼šåŒ…å«ä¸€äº›é¡å¤–ç§‘å­¸å‡½æ•¸çš„åº«ã€‚æˆ‘å€‘åœ¨è¨è«–æ¦‚ç‡å’Œçµ±è¨ˆæ™‚å·²ç¶“æ¥è§¸éé€™å€‹åº«

ä»¥ä¸‹æ˜¯æ‚¨é€šå¸¸åœ¨ Python ç¨‹å¼é–‹é ­ç”¨ä¾†å°å…¥é€™äº›åº«çš„ç¨‹å¼ç¢¼ï¼š
```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import ... # you need to specify exact sub-packages that you need
``` 

Pandas åœç¹å¹¾å€‹åŸºæœ¬æ¦‚å¿µé€²è¡Œè¨­è¨ˆã€‚

### Series

**Series** æ˜¯ä¸€ç³»åˆ—å€¼ï¼Œé¡ä¼¼æ–¼åˆ—è¡¨æˆ– numpy é™£åˆ—ã€‚ä¸»è¦å€åˆ¥åœ¨æ–¼ Series é‚„å…·æœ‰**ç´¢å¼•**ï¼Œç•¶æˆ‘å€‘å° Series é€²è¡Œæ“ä½œï¼ˆä¾‹å¦‚ç›¸åŠ ï¼‰æ™‚ï¼Œç´¢å¼•æœƒè¢«è€ƒæ…®ã€‚ç´¢å¼•å¯ä»¥åƒæ•´æ•¸è¡Œè™Ÿä¸€æ¨£ç°¡å–®ï¼ˆç•¶å¾åˆ—è¡¨æˆ–é™£åˆ—å‰µå»º Series æ™‚ï¼Œé»˜èªä½¿ç”¨æ­¤ç´¢å¼•ï¼‰ï¼Œä¹Ÿå¯ä»¥å…·æœ‰è¤‡é›œçµæ§‹ï¼Œä¾‹å¦‚æ—¥æœŸå€é–“ã€‚

> **æ³¨æ„**ï¼šåœ¨é™„å¸¶çš„ç­†è¨˜æœ¬ [`notebook.ipynb`](../../../../2-Working-With-Data/07-python/notebook.ipynb) ä¸­æœ‰ä¸€äº› Pandas çš„å…¥é–€ç¨‹å¼ç¢¼ã€‚æˆ‘å€‘åœ¨æ­¤åƒ…åˆ—å‡ºä¸€äº›ä¾‹å­ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å®Œæ•´çš„ç­†è¨˜æœ¬ã€‚

èˆ‰å€‹ä¾‹å­ï¼šæˆ‘å€‘æƒ³åˆ†æå†°æ·‡æ·‹åº—çš„éŠ·å”®æƒ…æ³ã€‚è®“æˆ‘å€‘ç”Ÿæˆä¸€æ®µæ™‚é–“å…§çš„éŠ·å”®æ•¸æ“šï¼ˆæ¯å¤©å”®å‡ºçš„å•†å“æ•¸é‡ï¼‰ï¼š
```python
start_date = "Jan 1, 2020"
end_date = "Mar 31, 2020"
idx = pd.date_range(start_date,end_date)
print(f"Length of index is {len(idx)}")
items_sold = pd.Series(np.random.randint(25,50,size=len(idx)),index=idx)
items_sold.plot()
```
![æ™‚é–“åºåˆ—åœ–](../../../../2-Working-With-Data/07-python/images/timeseries-1.png)

å‡è¨­æ¯é€±æˆ‘å€‘éƒ½æœƒèˆ‰è¾¦ä¸€æ¬¡èšæœƒï¼Œä¸¦é¡å¤–æº–å‚™ 10 ç›’å†°æ·‡æ·‹ã€‚æˆ‘å€‘å¯ä»¥å‰µå»ºå¦ä¸€å€‹ä»¥é€±ç‚ºç´¢å¼•çš„ Series ä¾†å±•ç¤ºé€™ä¸€é»ï¼š
```python
additional_items = pd.Series(10,index=pd.date_range(start_date,end_date,freq="W"))
```
ç•¶æˆ‘å€‘å°‡å…©å€‹ Series ç›¸åŠ æ™‚ï¼Œæˆ‘å€‘å¾—åˆ°ç¸½æ•¸ï¼š
```python
total_items = items_sold.add(additional_items,fill_value=0)
total_items.plot()
```
![æ™‚é–“åºåˆ—åœ–](../../../../2-Working-With-Data/07-python/images/timeseries-2.png)

> **æ³¨æ„**ï¼šæˆ‘å€‘ä¸¦æœªä½¿ç”¨ç°¡å–®çš„èªæ³• `total_items+additional_items`ã€‚å¦‚æœä½¿ç”¨æ­¤èªæ³•ï¼Œçµæœ Series ä¸­æœƒæœ‰è¨±å¤š `NaN`ï¼ˆ*éæ•¸å€¼*ï¼‰å€¼ã€‚é€™æ˜¯å› ç‚ºåœ¨ `additional_items` Series çš„æŸäº›ç´¢å¼•é»ç¼ºå°‘å€¼ï¼Œè€Œå°‡ `NaN` èˆ‡ä»»ä½•å€¼ç›¸åŠ æœƒå¾—åˆ° `NaN`ã€‚å› æ­¤ï¼Œæˆ‘å€‘éœ€è¦åœ¨ç›¸åŠ æ™‚æŒ‡å®š `fill_value` åƒæ•¸ã€‚

ä½¿ç”¨æ™‚é–“åºåˆ—ï¼Œæˆ‘å€‘é‚„å¯ä»¥**é‡æ–°å–æ¨£**ä¸åŒçš„æ™‚é–“é–“éš”ã€‚ä¾‹å¦‚ï¼Œå‡è¨­æˆ‘å€‘æƒ³è¨ˆç®—æ¯æœˆçš„å¹³å‡éŠ·å”®é‡ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š
```python
monthly = total_items.resample("1M").mean()
ax = monthly.plot(kind='bar')
```
![æ¯æœˆæ™‚é–“åºåˆ—å¹³å‡å€¼](../../../../2-Working-With-Data/07-python/images/timeseries-3.png)

### DataFrame

DataFrame æœ¬è³ªä¸Šæ˜¯å…·æœ‰ç›¸åŒç´¢å¼•çš„å¤šå€‹ Series çš„é›†åˆã€‚æˆ‘å€‘å¯ä»¥å°‡å¹¾å€‹ Series çµ„åˆæˆä¸€å€‹ DataFrameï¼š
```python
a = pd.Series(range(1,10))
b = pd.Series(["I","like","to","play","games","and","will","not","change"],index=range(0,9))
df = pd.DataFrame([a,b])
```
é€™å°‡å‰µå»ºå¦‚ä¸‹çš„æ°´å¹³è¡¨æ ¼ï¼š
|     | 0   | 1    | 2   | 3   | 4      | 5   | 6      | 7    | 8    |
| --- | --- | ---- | --- | --- | ------ | --- | ------ | ---- | ---- |
| 0   | 1   | 2    | 3   | 4   | 5      | 6   | 7      | 8    | 9    |
| 1   | I   | like | to  | use | Python | and | Pandas | very | much |

æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ Series ä½œç‚ºåˆ—ï¼Œä¸¦é€šéå­—å…¸æŒ‡å®šåˆ—åï¼š
```python
df = pd.DataFrame({ 'A' : a, 'B' : b })
```
é€™å°‡ç”Ÿæˆå¦‚ä¸‹è¡¨æ ¼ï¼š

|     | A   | B      |
| --- | --- | ------ |
| 0   | 1   | I      |
| 1   | 2   | like   |
| 2   | 3   | to     |
| 3   | 4   | use    |
| 4   | 5   | Python |
| 5   | 6   | and    |
| 6   | 7   | Pandas |
| 7   | 8   | very   |
| 8   | 9   | much   |

**æ³¨æ„**ï¼šæˆ‘å€‘ä¹Ÿå¯ä»¥é€šéè½‰ç½®å‰é¢çš„è¡¨æ ¼ä¾†ç²å¾—æ­¤è¡¨æ ¼ä½ˆå±€ï¼Œä¾‹å¦‚ï¼š
```python
df = pd.DataFrame([a,b]).T..rename(columns={ 0 : 'A', 1 : 'B' })
```
é€™è£¡ `.T` è¡¨ç¤ºè½‰ç½® DataFrame çš„æ“ä½œï¼Œå³äº¤æ›è¡Œå’Œåˆ—ï¼Œè€Œ `rename` æ“ä½œå…è¨±æˆ‘å€‘é‡å‘½ååˆ—ä»¥åŒ¹é…å‰é¢çš„ä¾‹å­ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘å€‘å¯ä»¥å° DataFrame åŸ·è¡Œçš„é‡è¦æ“ä½œï¼š

**åˆ—é¸æ“‡**ã€‚æˆ‘å€‘å¯ä»¥é€šé `df['A']` é¸æ“‡å–®å€‹åˆ—ï¼Œæ­¤æ“ä½œè¿”å›ä¸€å€‹ Seriesã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥é€šé `df[['B','A']]` é¸æ“‡åˆ—çš„å­é›†åˆ°å¦ä¸€å€‹ DataFrameï¼Œæ­¤æ“ä½œè¿”å›å¦ä¸€å€‹ DataFrameã€‚

**ç¯©é¸**ç¬¦åˆæ¢ä»¶çš„è¡Œã€‚ä¾‹å¦‚ï¼Œè¦åƒ…ä¿ç•™åˆ— `A` å¤§æ–¼ 5 çš„è¡Œï¼Œæˆ‘å€‘å¯ä»¥å¯« `df[df['A']>5]`ã€‚

> **æ³¨æ„**ï¼šç¯©é¸çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ã€‚è¡¨é”å¼ `df['A']<5` è¿”å›ä¸€å€‹å¸ƒæ— Seriesï¼ŒæŒ‡ç¤ºåŸå§‹ Series `df['A']` ä¸­æ¯å€‹å…ƒç´ æ˜¯å¦ç¬¦åˆæ¢ä»¶ã€‚ç•¶å¸ƒæ— Series ç”¨ä½œç´¢å¼•æ™‚ï¼Œå®ƒè¿”å› DataFrame ä¸­çš„è¡Œå­é›†ã€‚å› æ­¤ï¼Œä¸èƒ½ä½¿ç”¨ä»»æ„çš„ Python å¸ƒæ—è¡¨é”å¼ï¼Œä¾‹å¦‚ï¼Œå¯« `df[df['A']>5 and df['A']<7]` æ˜¯éŒ¯èª¤çš„ã€‚ç›¸åï¼Œæ‚¨æ‡‰ä½¿ç”¨å¸ƒæ— Series çš„ç‰¹æ®Š `&` æ“ä½œï¼Œå¯« `df[(df['A']>5) & (df['A']<7)]`ï¼ˆ*æ‹¬è™Ÿå¾ˆé‡è¦*ï¼‰ã€‚

**å‰µå»ºæ–°çš„å¯è¨ˆç®—åˆ—**ã€‚æˆ‘å€‘å¯ä»¥é€šéç›´è§€çš„è¡¨é”å¼è¼•é¬†ç‚º DataFrame å‰µå»ºæ–°çš„å¯è¨ˆç®—åˆ—ï¼š
```python
df['DivA'] = df['A']-df['A'].mean() 
``` 
æ­¤ä¾‹è¨ˆç®—åˆ— A èˆ‡å…¶å¹³å‡å€¼çš„åå·®ã€‚å¯¦éš›ä¸Šï¼Œæˆ‘å€‘æ˜¯åœ¨è¨ˆç®—ä¸€å€‹ Seriesï¼Œç„¶å¾Œå°‡æ­¤ Series åˆ†é…çµ¦å·¦å´ï¼Œå‰µå»ºå¦ä¸€åˆ—ã€‚å› æ­¤ï¼Œæˆ‘å€‘ä¸èƒ½ä½¿ç”¨èˆ‡ Series ä¸å…¼å®¹çš„æ“ä½œï¼Œä¾‹å¦‚ï¼Œä»¥ä¸‹ç¨‹å¼ç¢¼æ˜¯éŒ¯èª¤çš„ï¼š
```python
# Wrong code -> df['ADescr'] = "Low" if df['A'] < 5 else "Hi"
df['LenB'] = len(df['B']) # <- Wrong result
``` 
å¾Œä¸€å€‹ä¾‹å­é›–ç„¶èªæ³•æ­£ç¢ºï¼Œä½†çµæœéŒ¯èª¤ï¼Œå› ç‚ºå®ƒå°‡ Series `B` çš„é•·åº¦åˆ†é…çµ¦åˆ—ä¸­çš„æ‰€æœ‰å€¼ï¼Œè€Œä¸æ˜¯åˆ†é…çµ¦æ¯å€‹å…ƒç´ çš„é•·åº¦ã€‚

å¦‚æœéœ€è¦è¨ˆç®—æ­¤é¡è¤‡é›œè¡¨é”å¼ï¼Œå¯ä»¥ä½¿ç”¨ `apply` å‡½æ•¸ã€‚ä¸Šè¿°ä¾‹å­å¯ä»¥å¯«æˆï¼š
```python
df['LenB'] = df['B'].apply(lambda x : len(x))
# or 
df['LenB'] = df['B'].apply(len)
```

åŸ·è¡Œä¸Šè¿°æ“ä½œå¾Œï¼Œæˆ‘å€‘å°‡å¾—åˆ°ä»¥ä¸‹ DataFrameï¼š

|     | A   | B      | DivA | LenB |
| --- | --- | ------ | ---- | ---- |
| 0   | 1   | I      | -4.0 | 1    |
| 1   | 2   | like   | -3.0 | 4    |
| 2   | 3   | to     | -2.0 | 2    |
| 3   | 4   | use    | -1.0 | 3    |
| 4   | 5   | Python | 0.0  | 6    |
| 5   | 6   | and    | 1.0  | 3    |
| 6   | 7   | Pandas | 2.0  | 6    |
| 7   | 8   | very   | 3.0  | 4    |
| 8   | 9   | much   | 4.0  | 4    |

**åŸºæ–¼æ•¸å­—é¸æ“‡è¡Œ**å¯ä»¥ä½¿ç”¨ `iloc` çµæ§‹ã€‚ä¾‹å¦‚ï¼Œè¦é¸æ“‡ DataFrame çš„å‰ 5 è¡Œï¼š
```python
df.iloc[:5]
```

**åˆ†çµ„**é€šå¸¸ç”¨æ–¼ç²å¾—é¡ä¼¼ Excel ä¸­ *æ¨ç´åˆ†æè¡¨* çš„çµæœã€‚ä¾‹å¦‚ï¼Œæˆ‘å€‘æƒ³è¨ˆç®—åˆ— `A` çš„å¹³å‡å€¼ï¼ŒæŒ‰ `LenB` çš„å€¼åˆ†çµ„ã€‚é‚£éº¼æˆ‘å€‘å¯ä»¥æŒ‰ `LenB` åˆ†çµ„ DataFrameï¼Œç„¶å¾Œèª¿ç”¨ `mean`ï¼š
```python
df.groupby(by='LenB').mean()
```
å¦‚æœæˆ‘å€‘éœ€è¦è¨ˆç®—å¹³å‡å€¼å’Œçµ„ä¸­çš„å…ƒç´ æ•¸é‡ï¼Œå¯ä»¥ä½¿ç”¨æ›´è¤‡é›œçš„ `aggregate` å‡½æ•¸ï¼š
```python
df.groupby(by='LenB') \
 .aggregate({ 'DivA' : len, 'A' : lambda x: x.mean() }) \
 .rename(columns={ 'DivA' : 'Count', 'A' : 'Mean'})
```
é€™å°‡ç”Ÿæˆä»¥ä¸‹è¡¨æ ¼ï¼š

| LenB | Count | Mean     |
| ---- | ----- | -------- |
| 1    | 1     | 1.000000 |
| 2    | 1     | 3.000000 |
| 3    | 2     | 5.000000 |
| 4    | 3     | 6.333333 |
| 6    | 2     | 6.000000 |

### ç²å–æ•¸æ“š
æˆ‘å€‘å·²ç¶“çœ‹åˆ°å¦‚ä½•è¼•é¬†åœ°å¾ Python å°è±¡æ§‹å»º Series å’Œ DataFramesã€‚ç„¶è€Œï¼Œæ•¸æ“šé€šå¸¸ä»¥æ–‡æœ¬æ–‡ä»¶æˆ– Excel è¡¨æ ¼çš„å½¢å¼å­˜åœ¨ã€‚å¹¸é‹çš„æ˜¯ï¼ŒPandas ç‚ºæˆ‘å€‘æä¾›äº†ä¸€ç¨®ç°¡å–®çš„æ–¹æ³•ä¾†å¾ç£ç¢Ÿä¸­è¼‰å…¥æ•¸æ“šã€‚ä¾‹å¦‚ï¼Œè®€å– CSV æ–‡ä»¶å°±åƒé€™æ¨£ç°¡å–®ï¼š
```python
df = pd.read_csv('file.csv')
```
æˆ‘å€‘å°‡åœ¨â€œæŒ‘æˆ°â€éƒ¨åˆ†ä¸­çœ‹åˆ°æ›´å¤šè¼‰å…¥æ•¸æ“šçš„ä¾‹å­ï¼ŒåŒ…æ‹¬å¾å¤–éƒ¨ç¶²ç«™ç²å–æ•¸æ“šã€‚

### æ‰“å°èˆ‡ç¹ªåœ–

æ•¸æ“šç§‘å­¸å®¶ç¶“å¸¸éœ€è¦æ¢ç´¢æ•¸æ“šï¼Œå› æ­¤èƒ½å¤ å¯è¦–åŒ–æ•¸æ“šéå¸¸é‡è¦ã€‚ç•¶ DataFrame å¾ˆå¤§æ™‚ï¼Œæˆ‘å€‘é€šå¸¸åªéœ€è¦æ‰“å°å‡ºå‰å¹¾è¡Œä¾†ç¢ºä¿æˆ‘å€‘çš„æ“ä½œæ˜¯æ­£ç¢ºçš„ã€‚é€™å¯ä»¥é€šéèª¿ç”¨ `df.head()` å®Œæˆã€‚å¦‚æœä½ åœ¨ Jupyter Notebook ä¸­é‹è¡Œï¼Œå®ƒæœƒä»¥æ¼‚äº®çš„è¡¨æ ¼å½¢å¼æ‰“å°å‡º DataFrameã€‚

æˆ‘å€‘é‚„çœ‹åˆ°äº†ä½¿ç”¨ `plot` å‡½æ•¸ä¾†å¯è¦–åŒ–æŸäº›åˆ—çš„ä¾‹å­ã€‚é›–ç„¶ `plot` å°è¨±å¤šä»»å‹™éå¸¸æœ‰ç”¨ï¼Œä¸¦ä¸”é€šé `kind=` åƒæ•¸æ”¯æŒå¤šç¨®ä¸åŒçš„åœ–è¡¨é¡å‹ï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åŸå§‹çš„ `matplotlib` åº«ä¾†ç¹ªè£½æ›´è¤‡é›œçš„åœ–è¡¨ã€‚æˆ‘å€‘å°‡åœ¨å–®ç¨çš„èª²ç¨‹ä¸­è©³ç´°ä»‹ç´¹æ•¸æ“šå¯è¦–åŒ–ã€‚

é€™å€‹æ¦‚è¿°æ¶µè“‹äº† Pandas çš„æœ€é‡è¦æ¦‚å¿µï¼Œä½†é€™å€‹åº«éå¸¸è±å¯Œï¼Œå¹¾ä¹æ²’æœ‰ä½ ä¸èƒ½ç”¨å®ƒå®Œæˆçš„äº‹æƒ…ï¼ç¾åœ¨è®“æˆ‘å€‘æ‡‰ç”¨é€™äº›çŸ¥è­˜ä¾†è§£æ±ºå…·é«”å•é¡Œã€‚

## ğŸš€ æŒ‘æˆ° 1ï¼šåˆ†æ COVID å‚³æ’­

æˆ‘å€‘å°‡å°ˆæ³¨æ–¼çš„ç¬¬ä¸€å€‹å•é¡Œæ˜¯ COVID-19 çš„æµè¡Œç—…å‚³æ’­å»ºæ¨¡ã€‚ç‚ºäº†åšåˆ°é€™ä¸€é»ï¼Œæˆ‘å€‘å°‡ä½¿ç”¨ç”± [ç´„ç¿°éœæ™®é‡‘æ–¯å¤§å­¸](https://jhu.edu/) çš„ [ç³»çµ±ç§‘å­¸èˆ‡å·¥ç¨‹ä¸­å¿ƒ](https://systems.jhu.edu/) (CSSE) æä¾›çš„ä¸åŒåœ‹å®¶æ„ŸæŸ“äººæ•¸æ•¸æ“šã€‚æ•¸æ“šé›†å¯åœ¨ [é€™å€‹ GitHub å„²å­˜åº«](https://github.com/CSSEGISandData/COVID-19) ä¸­æ‰¾åˆ°ã€‚

ç”±æ–¼æˆ‘å€‘æƒ³å±•ç¤ºå¦‚ä½•è™•ç†æ•¸æ“šï¼Œæˆ‘å€‘é‚€è«‹ä½ æ‰“é–‹ [`notebook-covidspread.ipynb`](../../../../2-Working-With-Data/07-python/notebook-covidspread.ipynb) ä¸¦å¾é ­åˆ°å°¾é–±è®€ã€‚ä½ ä¹Ÿå¯ä»¥åŸ·è¡Œå–®å…ƒæ ¼ï¼Œä¸¦å®Œæˆæˆ‘å€‘åœ¨æœ€å¾Œç•™ä¸‹çš„ä¸€äº›æŒ‘æˆ°ã€‚

![COVID å‚³æ’­](../../../../2-Working-With-Data/07-python/images/covidspread.png)

> å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•åœ¨ Jupyter Notebook ä¸­é‹è¡Œä»£ç¢¼ï¼Œå¯ä»¥æŸ¥çœ‹ [é€™ç¯‡æ–‡ç« ](https://soshnikov.com/education/how-to-execute-notebooks-from-github/)ã€‚

## è™•ç†éçµæ§‹åŒ–æ•¸æ“š

é›–ç„¶æ•¸æ“šé€šå¸¸ä»¥è¡¨æ ¼å½¢å¼å­˜åœ¨ï¼Œä½†åœ¨æŸäº›æƒ…æ³ä¸‹æˆ‘å€‘éœ€è¦è™•ç†è¼ƒå°‘çµæ§‹åŒ–çš„æ•¸æ“šï¼Œä¾‹å¦‚æ–‡æœ¬æˆ–åœ–åƒã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œç‚ºäº†æ‡‰ç”¨æˆ‘å€‘ä¸Šé¢çœ‹åˆ°çš„æ•¸æ“šè™•ç†æŠ€è¡“ï¼Œæˆ‘å€‘éœ€è¦ä»¥æŸç¨®æ–¹å¼**æå–**çµæ§‹åŒ–æ•¸æ“šã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š

* å¾æ–‡æœ¬ä¸­æå–é—œéµå­—ï¼Œä¸¦æŸ¥çœ‹é€™äº›é—œéµå­—å‡ºç¾çš„é »ç‡
* ä½¿ç”¨ç¥ç¶“ç¶²çµ¡å¾åœ–ç‰‡ä¸­æå–æœ‰é—œç‰©é«”çš„ä¿¡æ¯
* ç²å–è¦–é »é¡é ­ä¸­äººå€‘çš„æƒ…æ„Ÿä¿¡æ¯

## ğŸš€ æŒ‘æˆ° 2ï¼šåˆ†æ COVID ç›¸é—œè«–æ–‡

åœ¨é€™å€‹æŒ‘æˆ°ä¸­ï¼Œæˆ‘å€‘å°‡ç¹¼çºŒæ¢è¨ COVID ç–«æƒ…çš„ä¸»é¡Œï¼Œä¸¦å°ˆæ³¨æ–¼è™•ç†ç›¸é—œçš„ç§‘å­¸è«–æ–‡ã€‚æœ‰ä¸€å€‹ [CORD-19 æ•¸æ“šé›†](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge)ï¼Œå…¶ä¸­åŒ…å«è¶…é 7000 ç¯‡ï¼ˆæ’°å¯«æ™‚ï¼‰é—œæ–¼ COVID çš„è«–æ–‡ï¼Œä¸¦æä¾›äº†å…ƒæ•¸æ“šå’Œæ‘˜è¦ï¼ˆå…¶ä¸­ç´„ä¸€åŠé‚„æä¾›äº†å…¨æ–‡ï¼‰ã€‚

ä½¿ç”¨ [Text Analytics for Health](https://docs.microsoft.com/azure/cognitive-services/text-analytics/how-tos/text-analytics-for-health/?WT.mc_id=academic-77958-bethanycheum) èªçŸ¥æœå‹™åˆ†ææ­¤æ•¸æ“šé›†çš„å®Œæ•´ç¤ºä¾‹å·²åœ¨ [é€™ç¯‡åšå®¢æ–‡ç« ](https://soshnikov.com/science/analyzing-medical-papers-with-azure-and-text-analytics-for-health/) ä¸­æè¿°ã€‚æˆ‘å€‘å°‡è¨è«–æ­¤åˆ†æçš„ç°¡åŒ–ç‰ˆæœ¬ã€‚

> **NOTE**: æˆ‘å€‘ä¸æä¾›æ­¤å„²å­˜åº«ä¸­çš„æ•¸æ“šé›†å‰¯æœ¬ã€‚ä½ å¯èƒ½éœ€è¦å…ˆå¾ [Kaggle ä¸Šçš„é€™å€‹æ•¸æ“šé›†](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge?select=metadata.csv) ä¸‹è¼‰ [`metadata.csv`](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge?select=metadata.csv) æ–‡ä»¶ã€‚å¯èƒ½éœ€è¦åœ¨ Kaggle è¨»å†Šã€‚ä½ ä¹Ÿå¯ä»¥å¾ [é€™è£¡](https://ai2-semanticscholar-cord-19.s3-us-west-2.amazonaws.com/historical_releases.html) ç„¡éœ€è¨»å†Šä¸‹è¼‰æ•¸æ“šé›†ï¼Œä½†å®ƒå°‡åŒ…æ‹¬æ‰€æœ‰å…¨æ–‡ä»¥åŠå…ƒæ•¸æ“šæ–‡ä»¶ã€‚

æ‰“é–‹ [`notebook-papers.ipynb`](../../../../2-Working-With-Data/07-python/notebook-papers.ipynb) ä¸¦å¾é ­åˆ°å°¾é–±è®€ã€‚ä½ ä¹Ÿå¯ä»¥åŸ·è¡Œå–®å…ƒæ ¼ï¼Œä¸¦å®Œæˆæˆ‘å€‘åœ¨æœ€å¾Œç•™ä¸‹çš„ä¸€äº›æŒ‘æˆ°ã€‚

![COVID é†«ç™‚è™•ç†](../../../../2-Working-With-Data/07-python/images/covidtreat.png)

## è™•ç†åœ–åƒæ•¸æ“š

æœ€è¿‘ï¼Œå·²ç¶“é–‹ç™¼å‡ºéå¸¸å¼·å¤§çš„ AI æ¨¡å‹ï¼Œèƒ½å¤ ç†è§£åœ–åƒã€‚æœ‰è¨±å¤šä»»å‹™å¯ä»¥ä½¿ç”¨é è¨“ç·´çš„ç¥ç¶“ç¶²çµ¡æˆ–é›²æœå‹™è§£æ±ºã€‚ä¸€äº›ä¾‹å­åŒ…æ‹¬ï¼š

* **åœ–åƒåˆ†é¡**ï¼Œå¯ä»¥å¹«åŠ©ä½ å°‡åœ–åƒåˆ†é¡åˆ°é å®šç¾©çš„é¡åˆ¥ä¹‹ä¸€ã€‚ä½ å¯ä»¥ä½¿ç”¨åƒ [Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum) é€™æ¨£çš„æœå‹™è¼•é¬†è¨“ç·´è‡ªå·±çš„åœ–åƒåˆ†é¡å™¨ã€‚
* **ç‰©é«”æª¢æ¸¬**ï¼Œç”¨æ–¼æª¢æ¸¬åœ–åƒä¸­çš„ä¸åŒç‰©é«”ã€‚åƒ [Computer Vision](https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum) é€™æ¨£çš„æœå‹™å¯ä»¥æª¢æ¸¬è¨±å¤šå¸¸è¦‹ç‰©é«”ï¼Œä½ ä¹Ÿå¯ä»¥è¨“ç·´ [Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum) æ¨¡å‹ä¾†æª¢æ¸¬ä¸€äº›ç‰¹å®šçš„æ„Ÿèˆˆè¶£ç‰©é«”ã€‚
* **äººè‡‰æª¢æ¸¬**ï¼ŒåŒ…æ‹¬å¹´é½¡ã€æ€§åˆ¥å’Œæƒ…æ„Ÿæª¢æ¸¬ã€‚é€™å¯ä»¥é€šé [Face API](https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum) å®Œæˆã€‚

æ‰€æœ‰é€™äº›é›²æœå‹™éƒ½å¯ä»¥é€šé [Python SDKs](https://docs.microsoft.com/samples/azure-samples/cognitive-services-python-sdk-samples/cognitive-services-python-sdk-samples/?WT.mc_id=academic-77958-bethanycheum) èª¿ç”¨ï¼Œå› æ­¤å¯ä»¥è¼•é¬†åœ°é›†æˆåˆ°ä½ çš„æ•¸æ“šæ¢ç´¢å·¥ä½œæµç¨‹ä¸­ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›æ¢ç´¢åœ–åƒæ•¸æ“šæºçš„ä¾‹å­ï¼š
* åœ¨åšå®¢æ–‡ç«  [å¦‚ä½•åœ¨ç„¡éœ€ç·¨ç¢¼çš„æƒ…æ³ä¸‹å­¸ç¿’æ•¸æ“šç§‘å­¸](https://soshnikov.com/azure/how-to-learn-data-science-without-coding/) ä¸­ï¼Œæˆ‘å€‘æ¢ç´¢ Instagram ç…§ç‰‡ï¼Œè©¦åœ–äº†è§£ä»€éº¼ä½¿äººå€‘æ›´å–œæ­¡æŸå¼µç…§ç‰‡ã€‚æˆ‘å€‘é¦–å…ˆä½¿ç”¨ [Computer Vision](https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum) å¾åœ–ç‰‡ä¸­æå–ç›¡å¯èƒ½å¤šçš„ä¿¡æ¯ï¼Œç„¶å¾Œä½¿ç”¨ [Azure Machine Learning AutoML](https://docs.microsoft.com/azure/machine-learning/concept-automated-ml/?WT.mc_id=academic-77958-bethanycheum) å»ºç«‹å¯è§£é‡‹çš„æ¨¡å‹ã€‚
* åœ¨ [Facial Studies Workshop](https://github.com/CloudAdvocacy/FaceStudies) ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨ [Face API](https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum) å¾æ´»å‹•ç…§ç‰‡ä¸­æå–äººå€‘çš„æƒ…æ„Ÿï¼Œè©¦åœ–äº†è§£ä»€éº¼ä½¿äººå€‘æ„Ÿåˆ°å¿«æ¨‚ã€‚

## çµè«–

ç„¡è«–ä½ æ“æœ‰çµæ§‹åŒ–é‚„æ˜¯éçµæ§‹åŒ–æ•¸æ“šï¼Œä½¿ç”¨ Python ä½ éƒ½å¯ä»¥å®Œæˆæ‰€æœ‰èˆ‡æ•¸æ“šè™•ç†å’Œç†è§£ç›¸é—œçš„æ­¥é©Ÿã€‚é€™å¯èƒ½æ˜¯æœ€éˆæ´»çš„æ•¸æ“šè™•ç†æ–¹å¼ï¼Œé€™ä¹Ÿæ˜¯å¤§å¤šæ•¸æ•¸æ“šç§‘å­¸å®¶å°‡ Python ä½œç‚ºä¸»è¦å·¥å…·çš„åŸå› ã€‚å¦‚æœä½ èªçœŸå°å¾…ä½ çš„æ•¸æ“šç§‘å­¸æ—…ç¨‹ï¼Œæ·±å…¥å­¸ç¿’ Python å¯èƒ½æ˜¯ä¸€å€‹å¥½ä¸»æ„ï¼

## [èª²å¾Œæ¸¬é©—](https://ff-quizzes.netlify.app/en/ds/quiz/13)

## å›é¡§èˆ‡è‡ªå­¸

**æ›¸ç±**
* [Wes McKinney. Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython](https://www.amazon.com/gp/product/1491957662)

**ç·šä¸Šè³‡æº**
* å®˜æ–¹ [10 åˆ†é˜å­¸ Pandas](https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html) æ•™ç¨‹
* [Pandas å¯è¦–åŒ–æ–‡æª”](https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html)

**å­¸ç¿’ Python**
* [ç”¨ Turtle Graphics å’Œåˆ†å½¢åœ–ä»¥æœ‰è¶£çš„æ–¹å¼å­¸ç¿’ Python](https://github.com/shwars/pycourse)
* [å¾ Python çš„ç¬¬ä¸€æ­¥é–‹å§‹](https://docs.microsoft.com/learn/paths/python-first-steps/?WT.mc_id=academic-77958-bethanycheum) åœ¨ [Microsoft Learn](http://learn.microsoft.com/?WT.mc_id=academic-77958-bethanycheum) ä¸Šçš„å­¸ç¿’è·¯å¾‘

## ä½œæ¥­

[å°ä¸Šè¿°æŒ‘æˆ°é€²è¡Œæ›´è©³ç´°çš„æ•¸æ“šç ”ç©¶](assignment.md)

## è‡´è¬

é€™ç¯€èª²ç”± [Dmitry Soshnikov](http://soshnikov.com) ç”¨ â™¥ï¸ ç·¨å¯«ã€‚

---

**å…è²¬è²æ˜**ï¼š  
æœ¬æ–‡ä»¶å·²ä½¿ç”¨ AI ç¿»è­¯æœå‹™ [Co-op Translator](https://github.com/Azure/co-op-translator) é€²è¡Œç¿»è­¯ã€‚å„˜ç®¡æˆ‘å€‘åŠªåŠ›ç¢ºä¿ç¿»è­¯çš„æº–ç¢ºæ€§ï¼Œä½†è«‹æ³¨æ„ï¼Œè‡ªå‹•ç¿»è­¯å¯èƒ½åŒ…å«éŒ¯èª¤æˆ–ä¸æº–ç¢ºä¹‹è™•ã€‚åŸå§‹æ–‡ä»¶çš„æ¯èªç‰ˆæœ¬æ‡‰è¢«è¦–ç‚ºæ¬Šå¨ä¾†æºã€‚å°æ–¼é—œéµä¿¡æ¯ï¼Œå»ºè­°ä½¿ç”¨å°ˆæ¥­äººå·¥ç¿»è­¯ã€‚æˆ‘å€‘å°å› ä½¿ç”¨æ­¤ç¿»è­¯è€Œå¼•èµ·çš„ä»»ä½•èª¤è§£æˆ–èª¤é‡‹ä¸æ‰¿æ“”è²¬ä»»ã€‚