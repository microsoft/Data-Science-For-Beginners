<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "116c5d361fbe812e59a73f37ce721d36",
  "translation_date": "2025-08-24T12:08:41+00:00",
  "source_file": "2-Working-With-Data/07-python/README.md",
  "language_code": "zh"
}
-->
# ä½¿ç”¨æ•°æ®ï¼šPython å’Œ Pandas åº“

| ![ ç”± [(@sketchthedocs)](https://sketchthedocs.dev) ç»˜åˆ¶çš„é€Ÿè®°å›¾ ](../../sketchnotes/07-WorkWithPython.png) |
| :-------------------------------------------------------------------------------------------------------: |
|                 ä½¿ç”¨ Python - _ç”± [@nitya](https://twitter.com/nitya) ç»˜åˆ¶çš„é€Ÿè®°å›¾_                        |

[![ä»‹ç»è§†é¢‘](../../../../2-Working-With-Data/07-python/images/video-ds-python.png)](https://youtu.be/dZjWOGbsN4Y)

å°½ç®¡æ•°æ®åº“æä¾›äº†éå¸¸é«˜æ•ˆçš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®å¹¶é€šè¿‡æŸ¥è¯¢è¯­è¨€è¿›è¡ŒæŸ¥è¯¢ï¼Œä½†æœ€çµæ´»çš„æ•°æ®å¤„ç†æ–¹å¼æ˜¯ç¼–å†™è‡ªå·±çš„ç¨‹åºæ¥æ“ä½œæ•°æ®ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä½¿ç”¨æ•°æ®åº“æŸ¥è¯¢å¯èƒ½æ›´æœ‰æ•ˆã€‚ç„¶è€Œï¼Œå½“éœ€è¦æ›´å¤æ‚çš„æ•°æ®å¤„ç†æ—¶ï¼ŒSQL å¯èƒ½æ— æ³•è½»æ¾å®ç°ã€‚  
æ•°æ®å¤„ç†å¯ä»¥ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼Œä½†æŸäº›è¯­è¨€åœ¨å¤„ç†æ•°æ®æ–¹é¢æ›´é«˜çº§ã€‚æ•°æ®ç§‘å­¦å®¶é€šå¸¸åå¥½ä»¥ä¸‹è¯­è¨€ä¹‹ä¸€ï¼š

* **[Python](https://www.python.org/)** æ˜¯ä¸€ç§é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œå› å…¶ç®€å•æ€§å¸¸è¢«è®¤ä¸ºæ˜¯åˆå­¦è€…çš„æœ€ä½³é€‰æ‹©ä¹‹ä¸€ã€‚Python æ‹¥æœ‰è®¸å¤šé¢å¤–çš„åº“ï¼Œå¯ä»¥å¸®åŠ©è§£å†³è®¸å¤šå®é™…é—®é¢˜ï¼Œä¾‹å¦‚ä» ZIP å‹ç¼©åŒ…ä¸­æå–æ•°æ®ï¼Œæˆ–å°†å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾åƒã€‚é™¤äº†æ•°æ®ç§‘å­¦ï¼ŒPython è¿˜å¸¸ç”¨äº Web å¼€å‘ã€‚
* **[R](https://www.r-project.org/)** æ˜¯ä¸€ä¸ªä¸ºç»Ÿè®¡æ•°æ®å¤„ç†è€Œå¼€å‘çš„ä¼ ç»Ÿå·¥å…·ç®±ã€‚å®ƒåŒ…å«å¤§é‡çš„åº“èµ„æºï¼ˆCRANï¼‰ï¼Œä½¿å…¶æˆä¸ºæ•°æ®å¤„ç†çš„è‰¯å¥½é€‰æ‹©ã€‚ç„¶è€Œï¼ŒR ä¸æ˜¯é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œå¾ˆå°‘åœ¨æ•°æ®ç§‘å­¦é¢†åŸŸä¹‹å¤–ä½¿ç”¨ã€‚
* **[Julia](https://julialang.org/)** æ˜¯å¦ä¸€ç§ä¸“ä¸ºæ•°æ®ç§‘å­¦å¼€å‘çš„è¯­è¨€ã€‚å®ƒæ—¨åœ¨æä¾›æ¯” Python æ›´å¥½çš„æ€§èƒ½ï¼Œæ˜¯ç§‘å­¦å®éªŒçš„å¼ºå¤§å·¥å…·ã€‚

åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºä½¿ç”¨ Python è¿›è¡Œç®€å•çš„æ•°æ®å¤„ç†ã€‚æˆ‘ä»¬å‡è®¾æ‚¨å¯¹è¯¥è¯­è¨€å·²æœ‰åŸºæœ¬äº†è§£ã€‚å¦‚æœæ‚¨æƒ³æ·±å…¥å­¦ä¹  Pythonï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹èµ„æºä¹‹ä¸€ï¼š

* [é€šè¿‡ Turtle Graphics å’Œåˆ†å½¢è¶£å‘³å­¦ä¹  Python](https://github.com/shwars/pycourse) - åŸºäº GitHub çš„ Python ç¼–ç¨‹å¿«é€Ÿå…¥é—¨è¯¾ç¨‹
* [è¿ˆå‡º Python çš„ç¬¬ä¸€æ­¥](https://docs.microsoft.com/en-us/learn/paths/python-first-steps/?WT.mc_id=academic-77958-bethanycheum) - [Microsoft Learn](http://learn.microsoft.com/?WT.mc_id=academic-77958-bethanycheum) ä¸Šçš„å­¦ä¹ è·¯å¾„

æ•°æ®å¯ä»¥æœ‰å¤šç§å½¢å¼ã€‚åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸‰ç§æ•°æ®å½¢å¼ï¼š**è¡¨æ ¼æ•°æ®**ã€**æ–‡æœ¬**å’Œ**å›¾åƒ**ã€‚

æˆ‘ä»¬å°†ä¸“æ³¨äºä¸€äº›æ•°æ®å¤„ç†çš„ç¤ºä¾‹ï¼Œè€Œä¸æ˜¯å…¨é¢ä»‹ç»æ‰€æœ‰ç›¸å…³åº“ã€‚è¿™å°†å¸®åŠ©æ‚¨äº†è§£ä¸»è¦æ¦‚å¿µï¼Œå¹¶åœ¨éœ€è¦æ—¶çŸ¥é“åœ¨å“ªé‡Œæ‰¾åˆ°è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚

> **æœ€æœ‰ç”¨çš„å»ºè®®**ï¼šå½“æ‚¨éœ€è¦å¯¹æ•°æ®æ‰§è¡ŒæŸäº›æ“ä½œä½†ä¸çŸ¥é“å¦‚ä½•å®ç°æ—¶ï¼Œå°è¯•åœ¨äº’è”ç½‘ä¸Šæœç´¢ã€‚[Stackoverflow](https://stackoverflow.com/) é€šå¸¸åŒ…å«è®¸å¤šå…³äº Python çš„æœ‰ç”¨ä»£ç ç¤ºä¾‹ï¼Œé€‚ç”¨äºè®¸å¤šå…¸å‹ä»»åŠ¡ã€‚

## [è¯¾å‰æµ‹éªŒ](https://purple-hill-04aebfb03.1.azurestaticapps.net/quiz/12)

## è¡¨æ ¼æ•°æ®å’Œæ•°æ®æ¡†

å½“æˆ‘ä»¬è®¨è®ºå…³ç³»å‹æ•°æ®åº“æ—¶ï¼Œæ‚¨å·²ç»æ¥è§¦è¿‡è¡¨æ ¼æ•°æ®ã€‚å½“æ‚¨æœ‰å¤§é‡æ•°æ®ï¼Œå¹¶ä¸”è¿™äº›æ•°æ®åŒ…å«åœ¨è®¸å¤šä¸åŒçš„å…³è”è¡¨ä¸­æ—¶ï¼Œä½¿ç”¨ SQL æ¥å¤„ç†å®ƒä»¬æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚ç„¶è€Œï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæ•°æ®è¡¨ï¼Œå¹¶ä¸”éœ€è¦å¯¹è¿™äº›æ•°æ®è·å¾—ä¸€äº›**ç†è§£**æˆ–**æ´å¯Ÿ**ï¼Œä¾‹å¦‚åˆ†å¸ƒæƒ…å†µã€å€¼ä¹‹é—´çš„ç›¸å…³æ€§ç­‰ã€‚åœ¨æ•°æ®ç§‘å­¦ä¸­ï¼Œå¸¸å¸¸éœ€è¦å¯¹åŸå§‹æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢ï¼Œç„¶åè¿›è¡Œå¯è§†åŒ–ã€‚è¿™ä¸¤ä¸ªæ­¥éª¤éƒ½å¯ä»¥é€šè¿‡ Python è½»æ¾å®Œæˆã€‚

Python ä¸­æœ‰ä¸¤ä¸ªæœ€æœ‰ç”¨çš„åº“å¯ä»¥å¸®åŠ©æ‚¨å¤„ç†è¡¨æ ¼æ•°æ®ï¼š
* **[Pandas](https://pandas.pydata.org/)** å…è®¸æ‚¨æ“ä½œæ‰€è°“çš„ **DataFrame**ï¼Œå®ƒç±»ä¼¼äºå…³ç³»å‹è¡¨æ ¼ã€‚æ‚¨å¯ä»¥æ‹¥æœ‰å‘½åçš„åˆ—ï¼Œå¹¶å¯¹è¡Œã€åˆ—å’Œæ•´ä¸ª DataFrame æ‰§è¡Œå„ç§æ“ä½œã€‚
* **[Numpy](https://numpy.org/)** æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† **å¼ é‡**ï¼ˆå³å¤šç»´**æ•°ç»„**ï¼‰çš„åº“ã€‚æ•°ç»„çš„å€¼å…·æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ï¼Œæ¯” DataFrame æ›´ç®€å•ï¼Œä½†æä¾›äº†æ›´å¤šæ•°å­¦æ“ä½œï¼Œå¹¶ä¸”å¼€é”€æ›´å°ã€‚

æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å€¼å¾—äº†è§£çš„åº“ï¼š
* **[Matplotlib](https://matplotlib.org/)** æ˜¯ä¸€ä¸ªç”¨äºæ•°æ®å¯è§†åŒ–å’Œç»˜åˆ¶å›¾è¡¨çš„åº“
* **[SciPy](https://www.scipy.org/)** æ˜¯ä¸€ä¸ªåŒ…å«ä¸€äº›é¢å¤–ç§‘å­¦å‡½æ•°çš„åº“ã€‚æˆ‘ä»¬åœ¨è®¨è®ºæ¦‚ç‡å’Œç»Ÿè®¡æ—¶å·²ç»æ¥è§¦è¿‡è¿™ä¸ªåº“

ä»¥ä¸‹æ˜¯æ‚¨é€šå¸¸åœ¨ Python ç¨‹åºå¼€å¤´å¯¼å…¥è¿™äº›åº“çš„ä»£ç ï¼š
```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import ... # you need to specify exact sub-packages that you need
``` 

Pandas å›´ç»•å‡ ä¸ªåŸºæœ¬æ¦‚å¿µæ„å»ºã€‚

### Series

**Series** æ˜¯ä¸€ç»„å€¼çš„åºåˆ—ï¼Œç±»ä¼¼äºåˆ—è¡¨æˆ– numpy æ•°ç»„ã€‚ä¸»è¦åŒºåˆ«åœ¨äº Series è¿˜å…·æœ‰ä¸€ä¸ª **ç´¢å¼•**ï¼Œå½“æˆ‘ä»¬å¯¹ Series è¿›è¡Œæ“ä½œï¼ˆä¾‹å¦‚ç›¸åŠ ï¼‰æ—¶ï¼Œä¼šè€ƒè™‘ç´¢å¼•ã€‚ç´¢å¼•å¯ä»¥æ˜¯ç®€å•çš„æ•´æ•°è¡Œå·ï¼ˆä»åˆ—è¡¨æˆ–æ•°ç»„åˆ›å»º Series æ—¶é»˜è®¤ä½¿ç”¨çš„ç´¢å¼•ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤æ‚çš„ç»“æ„ï¼Œä¾‹å¦‚æ—¥æœŸåŒºé—´ã€‚

> **æ³¨æ„**ï¼šåœ¨é…å¥—çš„ç¬”è®°æœ¬æ–‡ä»¶ [`notebook.ipynb`](../../../../2-Working-With-Data/07-python/notebook.ipynb) ä¸­æœ‰ä¸€äº› Pandas çš„å…¥é—¨ä»£ç ã€‚è¿™é‡Œä»…åˆ—å‡ºéƒ¨åˆ†ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å®Œæ•´çš„ç¬”è®°æœ¬æ–‡ä»¶ã€‚

ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬æƒ³åˆ†æå†°æ·‡æ·‹åº—çš„é”€å”®æƒ…å†µã€‚è®©æˆ‘ä»¬ç”Ÿæˆä¸€æ®µæ—¶é—´å†…çš„é”€å”®æ•°æ®ï¼ˆæ¯å¤©å”®å‡ºçš„å•†å“æ•°é‡ï¼‰ï¼š
```python
start_date = "Jan 1, 2020"
end_date = "Mar 31, 2020"
idx = pd.date_range(start_date,end_date)
print(f"Length of index is {len(idx)}")
items_sold = pd.Series(np.random.randint(25,50,size=len(idx)),index=idx)
items_sold.plot()
```
![æ—¶é—´åºåˆ—å›¾](../../../../2-Working-With-Data/07-python/images/timeseries-1.png)

å‡è®¾æ¯å‘¨æˆ‘ä»¬éƒ½ä¼šä¸ºæœ‹å‹ä¸¾åŠèšä¼šï¼Œå¹¶é¢å¤–å¸¦ 10 ç›’å†°æ·‡æ·‹ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¦ä¸€ä¸ªä»¥å‘¨ä¸ºç´¢å¼•çš„ Series æ¥è¡¨ç¤ºï¼š
```python
additional_items = pd.Series(10,index=pd.date_range(start_date,end_date,freq="W"))
```
å½“æˆ‘ä»¬å°†ä¸¤ä¸ª Series ç›¸åŠ æ—¶ï¼Œå°±å¾—åˆ°äº†æ€»æ•°ï¼š
```python
total_items = items_sold.add(additional_items,fill_value=0)
total_items.plot()
```
![æ—¶é—´åºåˆ—å›¾](../../../../2-Working-With-Data/07-python/images/timeseries-2.png)

> **æ³¨æ„** æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ç®€å•çš„è¯­æ³• `total_items+additional_items`ã€‚å¦‚æœè¿™æ ·åšï¼Œç»“æœ Series ä¸­ä¼šæœ‰è®¸å¤š `NaN`ï¼ˆ*éæ•°å­—*ï¼‰å€¼ã€‚è¿™æ˜¯å› ä¸ºåœ¨ `additional_items` Series çš„æŸäº›ç´¢å¼•ç‚¹ä¸Šç¼ºå°‘å€¼ï¼Œè€Œå°† `NaN` åŠ åˆ°ä»»ä½•å€¼éƒ½ä¼šå¾—åˆ° `NaN`ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç›¸åŠ æ—¶æŒ‡å®š `fill_value` å‚æ•°ã€‚

å¯¹äºæ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ—¶é—´é—´éš”å¯¹å…¶è¿›è¡Œ**é‡é‡‡æ ·**ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è®¡ç®—æ¯æœˆçš„å¹³å‡é”€å”®é‡ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š
```python
monthly = total_items.resample("1M").mean()
ax = monthly.plot(kind='bar')
```
![æ¯æœˆæ—¶é—´åºåˆ—å¹³å‡å€¼](../../../../2-Working-With-Data/07-python/images/timeseries-3.png)

### DataFrame

DataFrame æœ¬è´¨ä¸Šæ˜¯å…·æœ‰ç›¸åŒç´¢å¼•çš„å¤šä¸ª Series çš„é›†åˆã€‚æˆ‘ä»¬å¯ä»¥å°†å¤šä¸ª Series ç»„åˆæˆä¸€ä¸ª DataFrameï¼š
```python
a = pd.Series(range(1,10))
b = pd.Series(["I","like","to","play","games","and","will","not","change"],index=range(0,9))
df = pd.DataFrame([a,b])
```
è¿™å°†åˆ›å»ºå¦‚ä¸‹çš„æ°´å¹³è¡¨æ ¼ï¼š
|     | 0   | 1    | 2   | 3   | 4      | 5   | 6      | 7    | 8    |
| --- | --- | ---- | --- | --- | ------ | --- | ------ | ---- | ---- |
| 0   | 1   | 2    | 3   | 4   | 5      | 6   | 7      | 8    | 9    |
| 1   | I   | like | to  | use | Python | and | Pandas | very | much |

æˆ‘ä»¬è¿˜å¯ä»¥å°† Series ç”¨ä½œåˆ—ï¼Œå¹¶é€šè¿‡å­—å…¸æŒ‡å®šåˆ—åï¼š
```python
df = pd.DataFrame({ 'A' : a, 'B' : b })
```
è¿™å°†ç”Ÿæˆå¦‚ä¸‹è¡¨æ ¼ï¼š

|     | A   | B      |
| --- | --- | ------ |
| 0   | 1   | I      |
| 1   | 2   | like   |
| 2   | 3   | to     |
| 3   | 4   | use    |
| 4   | 5   | Python |
| 5   | 6   | and    |
| 6   | 7   | Pandas |
| 7   | 8   | very   |
| 8   | 9   | much   |

**æ³¨æ„** æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡è½¬ç½®å‰ä¸€ä¸ªè¡¨æ ¼æ¥è·å¾—è¿™ç§è¡¨æ ¼å¸ƒå±€ï¼Œä¾‹å¦‚ï¼š
```python
df = pd.DataFrame([a,b]).T..rename(columns={ 0 : 'A', 1 : 'B' })
```
è¿™é‡Œ `.T` è¡¨ç¤ºå¯¹ DataFrame è¿›è¡Œè½¬ç½®æ“ä½œï¼Œå³äº¤æ¢è¡Œå’Œåˆ—ï¼Œè€Œ `rename` æ“ä½œå…è®¸æˆ‘ä»¬é‡å‘½ååˆ—ä»¥åŒ¹é…å‰é¢çš„ç¤ºä¾‹ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹ DataFrame æ‰§è¡Œçš„ä¸€äº›æœ€é‡è¦çš„æ“ä½œï¼š

**åˆ—é€‰æ‹©**ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ `df['A']` é€‰æ‹©å•ä¸ªåˆ—â€”â€”æ­¤æ“ä½œè¿”å›ä¸€ä¸ª Seriesã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ `df[['B','A']]` é€‰æ‹©åˆ—çš„å­é›†åˆ°å¦ä¸€ä¸ª DataFrame ä¸­â€”â€”æ­¤æ“ä½œè¿”å›å¦ä¸€ä¸ª DataFrameã€‚

**æŒ‰æ¡ä»¶è¿‡æ»¤è¡Œ**ã€‚ä¾‹å¦‚ï¼Œè¦ä»…ä¿ç•™åˆ— `A` å¤§äº 5 çš„è¡Œï¼Œå¯ä»¥å†™ `df[df['A']>5]`ã€‚

> **æ³¨æ„**ï¼šè¿‡æ»¤çš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚è¡¨è¾¾å¼ `df['A']<5` è¿”å›ä¸€ä¸ªå¸ƒå°” Seriesï¼ŒæŒ‡ç¤ºåŸå§‹ Series `df['A']` ä¸­æ¯ä¸ªå…ƒç´ çš„è¡¨è¾¾å¼æ˜¯ `True` è¿˜æ˜¯ `False`ã€‚å½“å¸ƒå°” Series ç”¨ä½œç´¢å¼•æ—¶ï¼Œå®ƒè¿”å› DataFrame ä¸­çš„è¡Œå­é›†ã€‚å› æ­¤ï¼Œä¸èƒ½ä½¿ç”¨ä»»æ„çš„ Python å¸ƒå°”è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼Œå†™ `df[df['A']>5 and df['A']<7]` æ˜¯é”™è¯¯çš„ã€‚ç›¸åï¼Œæ‚¨åº”è¯¥å¯¹å¸ƒå°” Series ä½¿ç”¨ç‰¹æ®Šçš„ `&` æ“ä½œï¼Œå†™ä½œ `df[(df['A']>5) & (df['A']<7)]`ï¼ˆ*æ‹¬å·åœ¨è¿™é‡Œå¾ˆé‡è¦*ï¼‰ã€‚

**åˆ›å»ºæ–°çš„å¯è®¡ç®—åˆ—**ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´è§‚çš„è¡¨è¾¾å¼è½»æ¾ä¸º DataFrame åˆ›å»ºæ–°çš„å¯è®¡ç®—åˆ—ï¼š
```python
df['DivA'] = df['A']-df['A'].mean() 
``` 
æ­¤ç¤ºä¾‹è®¡ç®—åˆ— A åç¦»å…¶å¹³å‡å€¼çš„å·®å¼‚ã€‚å®é™…å‘ç”Ÿçš„æƒ…å†µæ˜¯æˆ‘ä»¬è®¡ç®—äº†ä¸€ä¸ª Seriesï¼Œç„¶åå°†å…¶åˆ†é…ç»™å·¦ä¾§ï¼Œåˆ›å»ºäº†å¦ä¸€ä¸ªåˆ—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸ Series ä¸å…¼å®¹çš„ä»»ä½•æ“ä½œï¼Œä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ˜¯é”™è¯¯çš„ï¼š
```python
# Wrong code -> df['ADescr'] = "Low" if df['A'] < 5 else "Hi"
df['LenB'] = len(df['B']) # <- Wrong result
``` 
åä¸€ä¸ªç¤ºä¾‹è™½ç„¶è¯­æ³•æ­£ç¡®ï¼Œä½†ä¼šç»™å‡ºé”™è¯¯çš„ç»“æœï¼Œå› ä¸ºå®ƒå°† Series `B` çš„é•¿åº¦åˆ†é…ç»™åˆ—ä¸­çš„æ‰€æœ‰å€¼ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„æ¯ä¸ªå…ƒç´ çš„é•¿åº¦ã€‚

å¦‚æœæˆ‘ä»¬éœ€è¦è®¡ç®—è¿™æ ·çš„å¤æ‚è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨ `apply` å‡½æ•°ã€‚æœ€åä¸€ä¸ªç¤ºä¾‹å¯ä»¥å†™æˆå¦‚ä¸‹ï¼š
```python
df['LenB'] = df['B'].apply(lambda x : len(x))
# or 
df['LenB'] = df['B'].apply(len)
```

ç»è¿‡ä¸Šè¿°æ“ä½œåï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä»¥ä¸‹ DataFrameï¼š

|     | A   | B      | DivA | LenB |
| --- | --- | ------ | ---- | ---- |
| 0   | 1   | I      | -4.0 | 1    |
| 1   | 2   | like   | -3.0 | 4    |
| 2   | 3   | to     | -2.0 | 2    |
| 3   | 4   | use    | -1.0 | 3    |
| 4   | 5   | Python | 0.0  | 6    |
| 5   | 6   | and    | 1.0  | 3    |
| 6   | 7   | Pandas | 2.0  | 6    |
| 7   | 8   | very   | 3.0  | 4    |
| 8   | 9   | much   | 4.0  | 4    |

**åŸºäºè¡Œå·é€‰æ‹©è¡Œ** å¯ä»¥ä½¿ç”¨ `iloc` æ„é€ ã€‚ä¾‹å¦‚ï¼Œè¦é€‰æ‹© DataFrame çš„å‰ 5 è¡Œï¼š
```python
df.iloc[:5]
```

**åˆ†ç»„** é€šå¸¸ç”¨äºè·å¾—ç±»ä¼¼äº Excel ä¸­ *æ•°æ®é€è§†è¡¨* çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è®¡ç®—åˆ— `A` çš„å¹³å‡å€¼ï¼ŒæŒ‰ `LenB` çš„ä¸åŒå€¼åˆ†ç»„ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ `LenB` å¯¹ DataFrame è¿›è¡Œåˆ†ç»„ï¼Œç„¶åè°ƒç”¨ `mean`ï¼š
```python
df.groupby(by='LenB').mean()
```
å¦‚æœæˆ‘ä»¬éœ€è¦è®¡ç®—å¹³å‡å€¼å’Œç»„ä¸­å…ƒç´ çš„æ•°é‡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„ `aggregate` å‡½æ•°ï¼š
```python
df.groupby(by='LenB') \
 .aggregate({ 'DivA' : len, 'A' : lambda x: x.mean() }) \
 .rename(columns={ 'DivA' : 'Count', 'A' : 'Mean'})
```
è¿™å°†ç”Ÿæˆä»¥ä¸‹è¡¨æ ¼ï¼š

| LenB | Count | Mean     |
| ---- | ----- | -------- |
| 1    | 1     | 1.000000 |
| 2    | 1     | 3.000000 |
| 3    | 2     | 5.000000 |
| 4    | 3     | 6.333333 |
| 6    | 2     | 6.000000 |

### è·å–æ•°æ®
æˆ‘ä»¬å·²ç»çœ‹åˆ°å¦‚ä½•è½»æ¾åœ°ä» Python å¯¹è±¡æ„å»º Series å’Œ DataFrameã€‚ç„¶è€Œï¼Œæ•°æ®é€šå¸¸ä»¥æ–‡æœ¬æ–‡ä»¶æˆ– Excel è¡¨æ ¼çš„å½¢å¼å­˜åœ¨ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPandas ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä»ç£ç›˜åŠ è½½æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè¯»å– CSV æ–‡ä»¶å°±åƒè¿™æ ·ç®€å•ï¼š
```python
df = pd.read_csv('file.csv')
```
æˆ‘ä»¬å°†åœ¨â€œæŒ‘æˆ˜â€éƒ¨åˆ†ä¸­çœ‹åˆ°æ›´å¤šåŠ è½½æ•°æ®çš„ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ä»å¤–éƒ¨ç½‘ç«™è·å–æ•°æ®ã€‚

### æ‰“å°å’Œç»˜å›¾

æ•°æ®ç§‘å­¦å®¶ç»å¸¸éœ€è¦æ¢ç´¢æ•°æ®ï¼Œå› æ­¤èƒ½å¤Ÿå¯è§†åŒ–æ•°æ®éå¸¸é‡è¦ã€‚å½“ DataFrame å¾ˆå¤§æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸åªéœ€è¦æ‰“å°å‡ºå‰å‡ è¡Œä»¥ç¡®ä¿æ“ä½œæ­£ç¡®ã€‚è¿™å¯ä»¥é€šè¿‡è°ƒç”¨ `df.head()` æ¥å®Œæˆã€‚å¦‚æœä½ åœ¨ Jupyter Notebook ä¸­è¿è¡Œï¼Œå®ƒä¼šä»¥æ¼‚äº®çš„è¡¨æ ¼å½¢å¼æ‰“å°å‡º DataFrameã€‚

æˆ‘ä»¬è¿˜è§è¿‡ä½¿ç”¨ `plot` å‡½æ•°æ¥å¯è§†åŒ–æŸäº›åˆ—ã€‚è™½ç„¶ `plot` å¯¹è®¸å¤šä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”é€šè¿‡ `kind=` å‚æ•°æ”¯æŒå¤šç§ä¸åŒçš„å›¾è¡¨ç±»å‹ï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åŸå§‹çš„ `matplotlib` åº“æ¥ç»˜åˆ¶æ›´å¤æ‚çš„å›¾è¡¨ã€‚æˆ‘ä»¬å°†åœ¨å•ç‹¬çš„è¯¾ç¨‹ä¸­è¯¦ç»†è®²è§£æ•°æ®å¯è§†åŒ–ã€‚

è¿™ä¸ªæ¦‚è¿°æ¶µç›–äº† Pandas çš„é‡è¦æ¦‚å¿µï¼Œä½†è¿™ä¸ªåº“éå¸¸ä¸°å¯Œï¼Œä½ å¯ä»¥ç”¨å®ƒåšæ— é™å¤šçš„äº‹æƒ…ï¼ç°åœ¨è®©æˆ‘ä»¬åº”ç”¨è¿™äº›çŸ¥è¯†æ¥è§£å†³å…·ä½“é—®é¢˜ã€‚

## ğŸš€ æŒ‘æˆ˜ 1ï¼šåˆ†æ COVID ä¼ æ’­

æˆ‘ä»¬å°†å…³æ³¨çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ COVID-19 çš„ç–«æƒ…ä¼ æ’­å»ºæ¨¡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç”± [çº¦ç¿°éœæ™®é‡‘æ–¯å¤§å­¦](https://jhu.edu/) çš„ [ç³»ç»Ÿç§‘å­¦ä¸å·¥ç¨‹ä¸­å¿ƒ](https://systems.jhu.edu/) (CSSE) æä¾›çš„ä¸åŒå›½å®¶æ„ŸæŸ“äººæ•°æ•°æ®ã€‚æ•°æ®é›†å¯ä»¥åœ¨ [è¿™ä¸ª GitHub ä»“åº“](https://github.com/CSSEGISandData/COVID-19) ä¸­æ‰¾åˆ°ã€‚

ç”±äºæˆ‘ä»¬æƒ³å±•ç¤ºå¦‚ä½•å¤„ç†æ•°æ®ï¼Œæˆ‘ä»¬é‚€è¯·ä½ æ‰“å¼€ [`notebook-covidspread.ipynb`](../../../../2-Working-With-Data/07-python/notebook-covidspread.ipynb) å¹¶ä»å¤´åˆ°å°¾é˜…è¯»ã€‚ä½ è¿˜å¯ä»¥æ‰§è¡Œå•å…ƒæ ¼ï¼Œå¹¶å®Œæˆæˆ‘ä»¬åœ¨æœ€åä¸ºä½ ç•™ä¸‹çš„ä¸€äº›æŒ‘æˆ˜ã€‚

![COVID ä¼ æ’­](../../../../2-Working-With-Data/07-python/images/covidspread.png)

> å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•åœ¨ Jupyter Notebook ä¸­è¿è¡Œä»£ç ï¼Œå¯ä»¥æŸ¥çœ‹ [è¿™ç¯‡æ–‡ç« ](https://soshnikov.com/education/how-to-execute-notebooks-from-github/)ã€‚

## å¤„ç†éç»“æ„åŒ–æ•°æ®

è™½ç„¶æ•°æ®é€šå¸¸ä»¥è¡¨æ ¼å½¢å¼å‡ºç°ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å¤„ç†è¾ƒå°‘ç»“æ„åŒ–çš„æ•°æ®ï¼Œä¾‹å¦‚æ–‡æœ¬æˆ–å›¾åƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†åº”ç”¨æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ•°æ®å¤„ç†æŠ€æœ¯ï¼Œæˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼**æå–**ç»“æ„åŒ–æ•°æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

* ä»æ–‡æœ¬ä¸­æå–å…³é”®è¯ï¼Œå¹¶æŸ¥çœ‹è¿™äº›å…³é”®è¯å‡ºç°çš„é¢‘ç‡
* ä½¿ç”¨ç¥ç»ç½‘ç»œä»å›¾ç‰‡ä¸­æå–æœ‰å…³å¯¹è±¡çš„ä¿¡æ¯
* è·å–è§†é¢‘æ‘„åƒå¤´ç”»é¢ä¸­äººç‰©çš„æƒ…æ„Ÿä¿¡æ¯

## ğŸš€ æŒ‘æˆ˜ 2ï¼šåˆ†æ COVID è®ºæ–‡

åœ¨è¿™ä¸ªæŒ‘æˆ˜ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­å…³æ³¨ COVID ç–«æƒ…çš„ä¸»é¢˜ï¼Œé‡ç‚¹å¤„ç†å…³äºè¯¥ä¸»é¢˜çš„ç§‘å­¦è®ºæ–‡ã€‚æœ‰ä¸€ä¸ª [CORD-19 æ•°æ®é›†](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge)ï¼Œå…¶ä¸­åŒ…å«è¶…è¿‡ 7000 ç¯‡ï¼ˆæ’°å†™æ—¶ï¼‰å…³äº COVID çš„è®ºæ–‡ï¼Œæä¾›äº†å…ƒæ•°æ®å’Œæ‘˜è¦ï¼ˆå…¶ä¸­çº¦ä¸€åŠè¿˜æä¾›äº†å…¨æ–‡ï¼‰ã€‚

ä½¿ç”¨ [Text Analytics for Health](https://docs.microsoft.com/azure/cognitive-services/text-analytics/how-tos/text-analytics-for-health/?WT.mc_id=academic-77958-bethanycheum) è®¤çŸ¥æœåŠ¡åˆ†æè¯¥æ•°æ®é›†çš„å®Œæ•´ç¤ºä¾‹å·²åœ¨ [è¿™ç¯‡åšå®¢æ–‡ç« ](https://soshnikov.com/science/analyzing-medical-papers-with-azure-and-text-analytics-for-health/) ä¸­æè¿°ã€‚æˆ‘ä»¬å°†è®¨è®ºæ­¤åˆ†æçš„ç®€åŒ–ç‰ˆæœ¬ã€‚

> **NOTE**: æˆ‘ä»¬æ²¡æœ‰åœ¨æ­¤ä»“åº“ä¸­æä¾›æ•°æ®é›†å‰¯æœ¬ã€‚ä½ å¯èƒ½éœ€è¦å…ˆä» [Kaggle ä¸Šçš„è¿™ä¸ªæ•°æ®é›†](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge?select=metadata.csv) ä¸‹è½½ [`metadata.csv`](https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge?select=metadata.csv) æ–‡ä»¶ã€‚å¯èƒ½éœ€è¦æ³¨å†Œ Kaggleã€‚ä½ ä¹Ÿå¯ä»¥ä» [è¿™é‡Œ](https://ai2-semanticscholar-cord-19.s3-us-west-2.amazonaws.com/historical_releases.html) ä¸‹è½½æ•°æ®é›†ï¼Œæ— éœ€æ³¨å†Œï¼Œä½†å®ƒå°†åŒ…æ‹¬æ‰€æœ‰å…¨æ–‡ä»¥åŠå…ƒæ•°æ®æ–‡ä»¶ã€‚

æ‰“å¼€ [`notebook-papers.ipynb`](../../../../2-Working-With-Data/07-python/notebook-papers.ipynb) å¹¶ä»å¤´åˆ°å°¾é˜…è¯»ã€‚ä½ è¿˜å¯ä»¥æ‰§è¡Œå•å…ƒæ ¼ï¼Œå¹¶å®Œæˆæˆ‘ä»¬åœ¨æœ€åä¸ºä½ ç•™ä¸‹çš„ä¸€äº›æŒ‘æˆ˜ã€‚

![COVID åŒ»ç–—å¤„ç†](../../../../2-Working-With-Data/07-python/images/covidtreat.png)

## å¤„ç†å›¾åƒæ•°æ®

æœ€è¿‘ï¼Œå¼€å‘äº†éå¸¸å¼ºå¤§çš„ AI æ¨¡å‹ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£å›¾åƒã€‚é€šè¿‡é¢„è®­ç»ƒçš„ç¥ç»ç½‘ç»œæˆ–äº‘æœåŠ¡ï¼Œå¯ä»¥è§£å†³è®¸å¤šä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

* **å›¾åƒåˆ†ç±»**ï¼Œå¯ä»¥å¸®åŠ©ä½ å°†å›¾åƒåˆ†ç±»åˆ°é¢„å®šä¹‰çš„ç±»åˆ«ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨è¯¸å¦‚ [Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum) çš„æœåŠ¡è½»æ¾è®­ç»ƒè‡ªå·±çš„å›¾åƒåˆ†ç±»å™¨ã€‚
* **å¯¹è±¡æ£€æµ‹**ï¼Œç”¨äºæ£€æµ‹å›¾åƒä¸­çš„ä¸åŒå¯¹è±¡ã€‚è¯¸å¦‚ [è®¡ç®—æœºè§†è§‰](https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum) çš„æœåŠ¡å¯ä»¥æ£€æµ‹è®¸å¤šå¸¸è§å¯¹è±¡ï¼Œä½ ä¹Ÿå¯ä»¥è®­ç»ƒ [Custom Vision](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum) æ¨¡å‹æ¥æ£€æµ‹ä¸€äº›ç‰¹å®šçš„å…´è¶£å¯¹è±¡ã€‚
* **äººè„¸æ£€æµ‹**ï¼ŒåŒ…æ‹¬å¹´é¾„ã€æ€§åˆ«å’Œæƒ…æ„Ÿæ£€æµ‹ã€‚è¿™å¯ä»¥é€šè¿‡ [Face API](https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum) æ¥å®Œæˆã€‚

æ‰€æœ‰è¿™äº›äº‘æœåŠ¡éƒ½å¯ä»¥é€šè¿‡ [Python SDKs](https://docs.microsoft.com/samples/azure-samples/cognitive-services-python-sdk-samples/cognitive-services-python-sdk-samples/?WT.mc_id=academic-77958-bethanycheum) è°ƒç”¨ï¼Œå› æ­¤å¯ä»¥è½»æ¾åœ°é›†æˆåˆ°ä½ çš„æ•°æ®æ¢ç´¢å·¥ä½œæµä¸­ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›ä»å›¾åƒæ•°æ®æºæ¢ç´¢æ•°æ®çš„ç¤ºä¾‹ï¼š
* åœ¨åšå®¢æ–‡ç«  [å¦‚ä½•åœ¨ä¸ç¼–ç¨‹çš„æƒ…å†µä¸‹å­¦ä¹ æ•°æ®ç§‘å­¦](https://soshnikov.com/azure/how-to-learn-data-science-without-coding/) ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢ Instagram ç…§ç‰‡ï¼Œè¯•å›¾äº†è§£æ˜¯ä»€ä¹ˆè®©äººä»¬å¯¹ä¸€å¼ ç…§ç‰‡ç‚¹èµæ›´å¤šã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ [è®¡ç®—æœºè§†è§‰](https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum) ä»å›¾ç‰‡ä¸­æå–å°½å¯èƒ½å¤šçš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨ [Azure Machine Learning AutoML](https://docs.microsoft.com/azure/machine-learning/concept-automated-ml/?WT.mc_id=academic-77958-bethanycheum) æ„å»ºå¯è§£é‡Šçš„æ¨¡å‹ã€‚
* åœ¨ [é¢éƒ¨ç ”ç©¶å·¥ä½œåŠ](https://github.com/CloudAdvocacy/FaceStudies) ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ [Face API](https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum) æå–æ´»åŠ¨ç…§ç‰‡ä¸­äººç‰©çš„æƒ…æ„Ÿï¼Œä»¥è¯•å›¾äº†è§£æ˜¯ä»€ä¹ˆè®©äººä»¬æ„Ÿåˆ°å¿«ä¹ã€‚

## ç»“è®º

æ— è®ºä½ å·²ç»æ‹¥æœ‰ç»“æ„åŒ–æ•°æ®è¿˜æ˜¯éç»“æ„åŒ–æ•°æ®ï¼Œä½¿ç”¨ Python éƒ½å¯ä»¥å®Œæˆä¸æ•°æ®å¤„ç†å’Œç†è§£ç›¸å…³çš„æ‰€æœ‰æ­¥éª¤ã€‚è¿™å¯èƒ½æ˜¯æ•°æ®å¤„ç†æœ€çµæ´»çš„æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°æ•°æ®ç§‘å­¦å®¶å°† Python ä½œä¸ºä¸»è¦å·¥å…·çš„åŸå› ã€‚å¦‚æœä½ è®¤çœŸå¯¹å¾…è‡ªå·±çš„æ•°æ®ç§‘å­¦ä¹‹æ—…ï¼Œæ·±å…¥å­¦ä¹  Python å¯èƒ½æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼

## [è¯¾åæµ‹éªŒ](https://purple-hill-04aebfb03.1.azurestaticapps.net/quiz/13)

## å¤ä¹ ä¸è‡ªå­¦

**ä¹¦ç±**
* [Wes McKinney. Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython](https://www.amazon.com/gp/product/1491957662)

**åœ¨çº¿èµ„æº**
* å®˜æ–¹ [10 åˆ†é’Ÿ Pandas](https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html) æ•™ç¨‹
* [Pandas å¯è§†åŒ–æ–‡æ¡£](https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html)

**å­¦ä¹  Python**
* [é€šè¿‡ Turtle Graphics å’Œåˆ†å½¢ä»¥æœ‰è¶£çš„æ–¹å¼å­¦ä¹  Python](https://github.com/shwars/pycourse)
* [é€šè¿‡ Microsoft Learn å­¦ä¹ è·¯å¾„](https://docs.microsoft.com/learn/paths/python-first-steps/?WT.mc_id=academic-77958-bethanycheum) [è¿ˆå‡º Python çš„ç¬¬ä¸€æ­¥](http://learn.microsoft.com/?WT.mc_id=academic-77958-bethanycheum)

## ä½œä¸š

[å¯¹ä¸Šè¿°æŒ‘æˆ˜è¿›è¡Œæ›´è¯¦ç»†çš„æ•°æ®ç ”ç©¶](assignment.md)

## è‡´è°¢

æœ¬è¯¾ç¨‹ç”± [Dmitry Soshnikov](http://soshnikov.com) â¤ï¸ åˆ›ä½œã€‚

**å…è´£å£°æ˜**ï¼š  
æœ¬æ–‡æ¡£ä½¿ç”¨AIç¿»è¯‘æœåŠ¡ [Co-op Translator](https://github.com/Azure/co-op-translator) è¿›è¡Œç¿»è¯‘ã€‚å°½ç®¡æˆ‘ä»¬åŠªåŠ›ç¡®ä¿ç¿»è¯‘çš„å‡†ç¡®æ€§ï¼Œä½†è¯·æ³¨æ„ï¼Œè‡ªåŠ¨ç¿»è¯‘å¯èƒ½åŒ…å«é”™è¯¯æˆ–ä¸å‡†ç¡®ä¹‹å¤„ã€‚åŸå§‹è¯­è¨€çš„æ–‡æ¡£åº”è¢«è§†ä¸ºæƒå¨æ¥æºã€‚å¯¹äºå…³é”®ä¿¡æ¯ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šäººå·¥ç¿»è¯‘ã€‚æˆ‘ä»¬å¯¹å› ä½¿ç”¨æ­¤ç¿»è¯‘è€Œäº§ç”Ÿçš„ä»»ä½•è¯¯è§£æˆ–è¯¯è¯»ä¸æ‰¿æ‹…è´£ä»»ã€‚